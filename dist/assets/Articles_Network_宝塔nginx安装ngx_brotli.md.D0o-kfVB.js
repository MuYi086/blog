import{_ as i,o as s,c as a,a7 as e}from"./chunks/framework.CgLK9O2D.js";const t="/assets/18.04_error.B9CZYrOB.png",n="/assets/internet_br.80BZziLU.jpg",x=JSON.parse('{"title":"宝塔nginx安装ngx_brotli","description":"","frontmatter":{"tags":["Network"]},"headers":[],"relativePath":"Articles/Network/宝塔nginx安装ngx_brotli.md","filePath":"Articles/Network/宝塔nginx安装ngx_brotli.md","lastUpdated":1719417334000}'),l={name:"Articles/Network/宝塔nginx安装ngx_brotli.md"},r=e('<h1 id="宝塔nginx安装ngx-brotli" tabindex="-1">宝塔nginx安装ngx_brotli <a class="header-anchor" href="#宝塔nginx安装ngx-brotli" aria-label="Permalink to &quot;宝塔nginx安装ngx_brotli&quot;">​</a></h1><h2 id="介绍" tabindex="-1">介绍 <a class="header-anchor" href="#介绍" aria-label="Permalink to &quot;介绍&quot;">​</a></h2><p><code>br</code> 是 <code>Brotli</code> 的缩写，是 <code>Google</code> 出的一种文件压缩工具，根据 <code>Google</code> 的官方数据和实际使用经验，<code>Brotli</code> 相对于 <code>Gzip</code> 可以实现更高的压缩率，有时候可以达到 <code>20-30%</code> 的压缩率提升。感兴趣可以参考这篇<a href="https://zhanzhangb.cn/tutorials/gzip-vs-brotli-better-compression.html" target="_blank" rel="noreferrer">Gzip vs Brotli 压缩算法，谁更好？及最优实施方案</a></p><p><code>nginx</code> 默认安装不带<code>brotli</code> 支持，所以我们需要手动编译安装 <code>nginx</code> 启用 <code>brotli</code> 支持。</p><div class="warning custom-block"><p class="custom-block-title">注意</p><p>无特殊需求，建议选极速安装，非必要不要选 <code>编译安装</code>, 相当的慢，我测试 <code>brotli</code>，在 <code>ubuntu 18.04</code> 和 <code>20.04</code> 上重新编译 <code>nginx</code> , 等了很长时间不提，最后还编译失败了。 <img src="'+t+`" alt="18.04_error" title="18.04_error"></p><p>最后，在 <code>22.04</code> 花了将近一个小时，终于编译成功。</p></div><h2 id="卸载已安装的nginx" tabindex="-1">卸载已安装的nginx <a class="header-anchor" href="#卸载已安装的nginx" aria-label="Permalink to &quot;卸载已安装的nginx&quot;">​</a></h2><p>如果面板还没有安装 <code>nginx</code> ，可以跳过此步骤。</p><p>登录宝塔面板 =&gt; 软件商品 =&gt; 已安装 =&gt; 找到 <code>nginx</code> =&gt; 卸载</p><h2 id="安装ngx-brotli" tabindex="-1">安装ngx_brotli <a class="header-anchor" href="#安装ngx-brotli" aria-label="Permalink to &quot;安装ngx_brotli&quot;">​</a></h2><ol><li><p>以 <code>root</code> 用户登录到 <code>vps</code> 终端</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 进入对应目录</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /www/server</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 下载ngx_brotli</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> clone</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --recurse-submodules</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -j8</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> https://github.com/google/ngx_brotli</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 添加ngx_brotli编译参数</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">echo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;--add-module=/www/server/ngx_brotli&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /www/server/panel/install/nginx_configure.pl</span></span></code></pre></div></li><li><p>宝塔面板 =&gt; 软件商品 =&gt; 搜索 <code>nginx</code> =&gt; 安装 =&gt; 勾选 <code>编译安装</code> =&gt; 提交</p></li></ol><h2 id="使用" tabindex="-1">使用 <a class="header-anchor" href="#使用" aria-label="Permalink to &quot;使用&quot;">​</a></h2><p>在宝塔面板新建一个网站，打开 <code>nginx</code> 配置文件，添加如下配置并保存。</p><div class="language-nginx vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">nginx</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">brotli</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> on</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">brotli_comp_level</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">brotli_buffers</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 16</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 8k</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">brotli_min_length</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 20</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">brotli_types</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> text/xml text/plain text/css application/javascript application/x-javascript application/rss+xml text/javascript image/tiff image/svg+xml application/json application/xml;</span></span></code></pre></div><p>再次访问网页，可以看到 <code>Content-Encoding: br</code>，说明成功了。 <img src="`+n+'" alt="internet_br" title="internet_br"></p><h2 id="参考" tabindex="-1">参考 <a class="header-anchor" href="#参考" aria-label="Permalink to &quot;参考&quot;">​</a></h2><ol><li><a href="https://www.bt.cn/new/download.html" target="_blank" rel="noreferrer">宝塔面板</a></li><li><a href="https://www.aapanel.com/new/download.html#install" target="_blank" rel="noreferrer">aaPanel</a></li><li><a href="https://developer.aliyun.com/article/1253206" target="_blank" rel="noreferrer">宝塔面板Nginx开启Brotli压缩，提升网站加载速度-【给网站提提速】</a></li><li><a href="https://zhanzhangb.cn/tutorials/nginx-quic-brotli-bt.html" target="_blank" rel="noreferrer">Nginx 启用 QUIC 与 Brotli 的完整教程(宝塔面板8.0.6)</a></li><li><a href="https://zhanzhangb.cn/tutorials/gzip-vs-brotli-better-compression.html" target="_blank" rel="noreferrer">Gzip vs Brotli 压缩算法，谁更好？及最优实施方案</a></li></ol><div style="display:none;" data-pagefind-meta="base64:JTdCJTIydGFncyUyMiUzQSU1QiUyMk5ldHdvcmslMjIlNUQlMkMlMjJkYXRlJTIyJTNBMTcxOTQxNzMzNDAwMCU3RA=="></div>',17),o=[r];function p(h,d,c,g,k,b){return s(),a("div",null,o)}const m=i(l,[["render",p]]);export{x as __pageData,m as default};
